Running FedStream with: Dir=0.5, Init_Class=6
Using downloaded and verified file: ../data/train_32x32.mat
Using downloaded and verified file: ../data/test_32x32.mat
has read
Using downloaded and verified file: ../data/train_32x32.mat
Using downloaded and verified file: ../data/test_32x32.mat
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:53<43:17, 53.01s/it]  4%|▍         | 2/50 [01:35<37:14, 46.55s/it]  6%|▌         | 3/50 [02:17<34:55, 44.59s/it]  8%|▊         | 4/50 [02:59<33:24, 43.58s/it] 10%|█         | 5/50 [03:41<32:21, 43.14s/it] 12%|█▏        | 6/50 [04:34<34:05, 46.48s/it] 14%|█▍        | 7/50 [05:17<32:29, 45.34s/it] 16%|█▌        | 8/50 [06:00<31:08, 44.50s/it] 18%|█▊        | 9/50 [06:43<30:02, 43.97s/it] 20%|██        | 10/50 [07:26<29:14, 43.87s/it] 22%|██▏       | 11/50 [08:25<31:32, 48.54s/it] 24%|██▍       | 12/50 [09:16<31:13, 49.30s/it] 26%|██▌       | 13/50 [10:03<29:56, 48.57s/it] 28%|██▊       | 14/50 [10:47<28:12, 47.02s/it] 30%|███       | 15/50 [11:37<28:00, 48.02s/it] 32%|███▏      | 16/50 [12:40<29:41, 52.41s/it] 34%|███▍      | 17/50 [13:27<27:59, 50.89s/it] 36%|███▌      | 18/50 [14:19<27:22, 51.34s/it] 38%|███▊      | 19/50 [15:08<26:05, 50.49s/it] 40%|████      | 20/50 [15:57<25:04, 50.15s/it] 42%|████▏     | 21/50 [16:59<25:58, 53.75s/it] 44%|████▍     | 22/50 [17:50<24:36, 52.72s/it] 46%|████▌     | 23/50 [18:39<23:16, 51.73s/it] 48%|████▊     | 24/50 [19:30<22:14, 51.31s/it] 50%|█████     | 25/50 [20:24<21:44, 52.16s/it] 52%|█████▏    | 26/50 [21:29<22:29, 56.24s/it] 54%|█████▍    | 27/50 [22:23<21:15, 55.47s/it] 56%|█████▌    | 28/50 [23:20<20:28, 55.85s/it] 58%|█████▊    | 29/50 [24:16<19:35, 55.99s/it] 60%|██████    | 30/50 [25:15<18:53, 56.70s/it] 62%|██████▏   | 31/50 [26:26<19:23, 61.22s/it] 64%|██████▍   | 32/50 [27:23<17:58, 59.90s/it] 66%|██████▌   | 33/50 [28:32<17:41, 62.46s/it] 68%|██████▊   | 34/50 [29:36<16:48, 63.01s/it] 70%|███████   | 35/50 [30:42<15:59, 63.97s/it] 72%|███████▏  | 36/50 [31:55<15:35, 66.79s/it] 74%|███████▍  | 37/50 [32:59<14:17, 65.96s/it] 76%|███████▌  | 38/50 [34:09<13:24, 67.05s/it] 78%|███████▊  | 39/50 [35:18<12:23, 67.58s/it] 80%|████████  | 40/50 [36:23<11:09, 66.94s/it] 82%|████████▏ | 41/50 [37:39<10:25, 69.44s/it] 84%|████████▍ | 42/50 [38:40<08:57, 67.17s/it] 86%|████████▌ | 43/50 [39:39<07:31, 64.53s/it] 88%|████████▊ | 44/50 [40:39<06:19, 63.19s/it] 90%|█████████ | 45/50 [41:42<05:16, 63.25s/it] 92%|█████████▏| 46/50 [42:56<04:25, 66.43s/it] 94%|█████████▍| 47/50 [43:57<03:14, 64.70s/it] 96%|█████████▌| 48/50 [44:57<02:06, 63.22s/it] 98%|█████████▊| 49/50 [45:59<01:03, 63.11s/it]100%|██████████| 50/50 [47:25<00:00, 69.83s/it]100%|██████████| 50/50 [47:25<00:00, 56.91s/it]
3 257 [5 4 2]
3 234 [3 5 1]
3 251 [3 2 5]
3 253 [1 3 0]
3 257 [1 4 2]
3 0 [5 4 2]
3 0 [3 5 1]
4 0 [3 2 5 6]
4 0 [1 3 0 6]
4 0 [1 4 2 6]
3 0 [5 4 2]
3 0 [3 5 1]
5 0 [3 2 5 6 7]
4 0 [1 3 0 6]
5 0 [1 4 2 6 7]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
4 0 [1 3 0 6]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
3 0 [5 4 2]
4 0 [3 5 1 8]
6 0 [3 2 5 6 7 8]
5 0 [1 3 0 6 9]
6 0 [1 4 2 6 7 8]
Using downloaded and verified file: ../data/train_32x32.mat
Using downloaded and verified file: ../data/test_32x32.mat
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:53<43:22, 53.11s/it]  4%|▍         | 2/50 [01:20<30:24, 38.01s/it]  6%|▌         | 3/50 [01:37<22:19, 28.50s/it]  8%|▊         | 4/50 [01:51<17:22, 22.67s/it] 10%|█         | 5/50 [02:03<13:59, 18.66s/it] 12%|█▏        | 6/50 [02:22<13:54, 18.96s/it] 14%|█▍        | 7/50 [02:33<11:43, 16.35s/it] 16%|█▌        | 8/50 [02:43<10:00, 14.31s/it] 18%|█▊        | 9/50 [02:54<09:03, 13.25s/it] 20%|██        | 10/50 [03:03<08:01, 12.04s/it] 22%|██▏       | 11/50 [03:23<09:21, 14.40s/it] 24%|██▍       | 12/50 [03:33<08:11, 12.93s/it] 26%|██▌       | 13/50 [03:42<07:20, 11.90s/it] 28%|██▊       | 14/50 [03:52<06:49, 11.39s/it] 30%|███       | 15/50 [04:03<06:36, 11.32s/it] 32%|███▏      | 16/50 [04:23<07:48, 13.78s/it] 34%|███▍      | 17/50 [04:32<06:51, 12.48s/it] 36%|███▌      | 18/50 [04:42<06:10, 11.58s/it] 38%|███▊      | 19/50 [04:52<05:47, 11.21s/it] 40%|████      | 20/50 [05:02<05:21, 10.71s/it] 42%|████▏     | 21/50 [05:23<06:43, 13.91s/it] 44%|████▍     | 22/50 [05:32<05:50, 12.53s/it] 46%|████▌     | 23/50 [05:43<05:21, 11.92s/it] 48%|████▊     | 24/50 [05:54<04:59, 11.52s/it] 50%|█████     | 25/50 [06:05<04:45, 11.42s/it] 52%|█████▏    | 26/50 [06:24<05:31, 13.81s/it] 54%|█████▍    | 27/50 [06:34<04:50, 12.63s/it] 56%|█████▌    | 28/50 [06:44<04:23, 11.96s/it] 58%|█████▊    | 29/50 [06:55<03:59, 11.42s/it] 60%|██████    | 30/50 [07:04<03:38, 10.95s/it] 62%|██████▏   | 31/50 [07:23<04:14, 13.38s/it] 62%|██████▏   | 31/50 [07:28<04:34, 14.45s/it]
3 257 [4 0 3]
3 234 [0 1 4]
3 251 [3 1 0]
3 253 [1 0 2]
3 257 [5 3 0]
3 9 [4 0 3]
4 7 [0 1 4 6]
3 9 [3 1 0]
4 7 [1 0 2 6]
3 9 [5 3 0]
3 16 [4 0 3]
4 12 [0 1 4 6]
3 16 [3 1 0]
4 12 [1 0 2 6]
3 16 [5 3 0]
4 16 [4 0 3 8]
5 12 [0 1 4 6 8]
3 21 [3 1 0]
5 12 [1 0 2 6 8]
4 16 [5 3 0 8]
4 17 [4 0 3 8]
6 12 [0 1 4 6 8 9]
3 23 [3 1 0]
5 14 [1 0 2 6 8]
5 14 [5 3 0 8 9]
4 18 [4 0 3 8]
6 12 [0 1 4 6 8 9]
3 24 [3 1 0]
5 14 [1 0 2 6 8]
5 14 [5 3 0 8 9]
4 19 [4 0 3 8]
6 12 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 19 [4 0 3 8]
6 12 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 18 [4 0 3 8]
6 13 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 19 [4 0 3 8]
6 12 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 19 [4 0 3 8]
6 12 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 18 [4 0 3 8]
6 13 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 19 [4 0 3 8]
6 12 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 19 [4 0 3 8]
6 12 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 18 [4 0 3 8]
6 13 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 19 [4 0 3 8]
6 12 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 19 [4 0 3 8]
6 12 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 18 [4 0 3 8]
6 13 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 19 [4 0 3 8]
6 12 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 19 [4 0 3 8]
6 12 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 18 [4 0 3 8]
6 13 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 19 [4 0 3 8]
6 12 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 19 [4 0 3 8]
6 12 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 18 [4 0 3 8]
6 13 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 19 [4 0 3 8]
6 12 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 19 [4 0 3 8]
6 13 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 19 [4 0 3 8]
6 12 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 19 [4 0 3 8]
6 13 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 19 [4 0 3 8]
6 12 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 19 [4 0 3 8]
6 13 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 19 [4 0 3 8]
6 12 [0 1 4 6 8 9]
3 25 [3 1 0]
5 15 [1 0 2 6 8]
5 15 [5 3 0 8 9]
4 19 [4 0 3 8]
6 13 [0 1 4 6 8 9]
3 25 [3 1 0]
Traceback (most recent call last):
  File "/home/kemove/lt/FedAlgorithm/alg/FedStream.py", line 763, in <module>
    
  File "/home/kemove/lt/FedAlgorithm/alg/FedStream.py", line 707, in online_train
    global_loss_list, accuracy_list = self.alg.run(
                                      ^^^^^^^^^^^^^
  File "/home/kemove/lt/FedAlgorithm/alg/FedAvg.py", line 127, in run
    result = self.client_group.clients[k].local_update_avg(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kemove/lt/FedAlgorithm/alg/Clients.py", line 199, in local_update_avg
    self.collect_data(t, k, increment)
  File "/home/kemove/lt/FedAlgorithm/alg/Clients.py", line 165, in collect_data
    used = random.sample(idcs, volume)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/random.py", line 456, in sample
    raise ValueError("Sample larger than population or is negative")
ValueError: Sample larger than population or is negative
