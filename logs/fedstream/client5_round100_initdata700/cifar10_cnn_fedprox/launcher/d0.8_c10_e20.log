Running FedStream with: Dir=0.8, Init_Class=10, Epoch=20
Files already downloaded and verified
Files already downloaded and verified
has read
Files already downloaded and verified
Files already downloaded and verified
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:52<1:26:14, 52.27s/it]  2%|▏         | 2/100 [01:52<1:32:49, 56.83s/it]  3%|▎         | 3/100 [03:05<1:43:54, 64.27s/it]  4%|▍         | 4/100 [04:30<1:55:58, 72.48s/it]  5%|▌         | 5/100 [06:00<2:04:54, 78.89s/it]  6%|▌         | 6/100 [07:38<2:13:23, 85.14s/it]  7%|▋         | 7/100 [09:15<2:18:03, 89.06s/it]  8%|▊         | 8/100 [10:53<2:21:01, 91.98s/it]  9%|▉         | 9/100 [12:31<2:22:16, 93.81s/it] 10%|█         | 10/100 [14:08<2:22:28, 94.98s/it] 11%|█         | 11/100 [15:50<2:24:07, 97.16s/it] 12%|█▏        | 12/100 [17:31<2:23:52, 98.09s/it] 13%|█▎        | 13/100 [19:11<2:23:07, 98.70s/it] 14%|█▍        | 14/100 [20:53<2:22:53, 99.69s/it] 15%|█▌        | 15/100 [22:34<2:21:49, 100.11s/it] 16%|█▌        | 16/100 [24:18<2:21:56, 101.38s/it] 17%|█▋        | 17/100 [26:00<2:20:14, 101.38s/it] 18%|█▊        | 18/100 [27:41<2:18:32, 101.38s/it] 19%|█▉        | 19/100 [29:22<2:16:54, 101.41s/it] 20%|██        | 20/100 [31:04<2:15:12, 101.40s/it] 21%|██        | 21/100 [32:49<2:15:00, 102.53s/it] 22%|██▏       | 22/100 [34:31<2:13:12, 102.47s/it] 23%|██▎       | 23/100 [36:15<2:11:59, 102.85s/it] 24%|██▍       | 24/100 [37:58<2:10:14, 102.82s/it] 25%|██▌       | 25/100 [39:42<2:08:59, 103.19s/it] 26%|██▌       | 26/100 [41:29<2:08:55, 104.53s/it] 27%|██▋       | 27/100 [43:15<2:07:26, 104.75s/it] 28%|██▊       | 28/100 [45:00<2:05:56, 104.96s/it] 29%|██▉       | 29/100 [46:45<2:04:17, 105.03s/it] 30%|███       | 30/100 [48:31<2:02:42, 105.19s/it] 31%|███       | 31/100 [50:19<2:02:05, 106.16s/it] 32%|███▏      | 32/100 [52:04<1:59:45, 105.67s/it] 33%|███▎      | 33/100 [53:50<1:58:06, 105.77s/it] 34%|███▍      | 34/100 [55:35<1:56:11, 105.63s/it] 35%|███▌      | 35/100 [57:20<1:54:19, 105.53s/it] 36%|███▌      | 36/100 [59:10<1:53:45, 106.65s/it] 37%|███▋      | 37/100 [1:00:58<1:52:23, 107.05s/it] 38%|███▊      | 38/100 [1:02:43<1:50:05, 106.53s/it] 39%|███▉      | 39/100 [1:04:29<1:48:07, 106.35s/it] 40%|████      | 40/100 [1:06:11<1:45:02, 105.05s/it] 41%|████      | 41/100 [1:07:48<1:41:03, 102.77s/it] 41%|████      | 41/100 [1:09:21<1:39:48, 101.51s/it]
8 96 [8 0 4 3 9 1 2 6]
8 88 [5 8 3 9 2 1 0 7]
8 94 [0 6 9 3 2 4 5 1]
8 95 [0 6 1 3 2 7 8 9]
8 96 [3 5 6 7 0 2 1 9]
8 70 [8 0 4 3 9 1 2 6]
8 69 [5 8 3 9 2 1 0 7]
8 69 [0 6 9 3 2 4 5 1]
8 69 [0 6 1 3 2 7 8 9]
8 70 [3 5 6 7 0 2 1 9]
8 83 [8 0 4 3 9 1 2 6]
8 83 [5 8 3 9 2 1 0 7]
8 83 [0 6 9 3 2 4 5 1]
8 83 [0 6 1 3 2 7 8 9]
8 83 [3 5 6 7 0 2 1 9]
8 90 [8 0 4 3 9 1 2 6]
8 90 [5 8 3 9 2 1 0 7]
8 90 [0 6 9 3 2 4 5 1]
8 90 [0 6 1 3 2 7 8 9]
8 90 [3 5 6 7 0 2 1 9]
8 94 [8 0 4 3 9 1 2 6]
8 94 [5 8 3 9 2 1 0 7]
8 94 [0 6 9 3 2 4 5 1]
8 94 [0 6 1 3 2 7 8 9]
8 94 [3 5 6 7 0 2 1 9]
8 96 [8 0 4 3 9 1 2 6]
8 96 [5 8 3 9 2 1 0 7]
8 96 [0 6 9 3 2 4 5 1]
8 96 [0 6 1 3 2 7 8 9]
8 96 [3 5 6 7 0 2 1 9]
8 96 [8 0 4 3 9 1 2 6]
8 96 [5 8 3 9 2 1 0 7]
8 96 [0 6 9 3 2 4 5 1]
8 96 [0 6 1 3 2 7 8 9]
8 96 [3 5 6 7 0 2 1 9]
8 96 [8 0 4 3 9 1 2 6]
8 96 [5 8 3 9 2 1 0 7]
8 96 [0 6 9 3 2 4 5 1]
8 96 [0 6 1 3 2 7 8 9]
8 96 [3 5 6 7 0 2 1 9]
8 97 [8 0 4 3 9 1 2 6]
8 97 [5 8 3 9 2 1 0 7]
8 97 [0 6 9 3 2 4 5 1]
8 97 [0 6 1 3 2 7 8 9]
8 97 [3 5 6 7 0 2 1 9]
8 96 [8 0 4 3 9 1 2 6]
8 96 [5 8 3 9 2 1 0 7]
8 96 [0 6 9 3 2 4 5 1]
8 96 [0 6 1 3 2 7 8 9]
8 96 [3 5 6 7 0 2 1 9]
8 97 [8 0 4 3 9 1 2 6]
8 97 [5 8 3 9 2 1 0 7]
8 97 [0 6 9 3 2 4 5 1]
8 97 [0 6 1 3 2 7 8 9]
8 97 [3 5 6 7 0 2 1 9]
8 96 [8 0 4 3 9 1 2 6]
8 96 [5 8 3 9 2 1 0 7]
8 96 [0 6 9 3 2 4 5 1]
8 96 [0 6 1 3 2 7 8 9]
8 96 [3 5 6 7 0 2 1 9]
8 97 [8 0 4 3 9 1 2 6]
8 97 [5 8 3 9 2 1 0 7]
8 97 [0 6 9 3 2 4 5 1]
8 97 [0 6 1 3 2 7 8 9]
8 97 [3 5 6 7 0 2 1 9]
8 96 [8 0 4 3 9 1 2 6]
8 96 [5 8 3 9 2 1 0 7]
8 96 [0 6 9 3 2 4 5 1]
8 96 [0 6 1 3 2 7 8 9]
8 96 [3 5 6 7 0 2 1 9]
8 97 [8 0 4 3 9 1 2 6]
8 97 [5 8 3 9 2 1 0 7]
8 97 [0 6 9 3 2 4 5 1]
8 97 [0 6 1 3 2 7 8 9]
8 97 [3 5 6 7 0 2 1 9]
8 96 [8 0 4 3 9 1 2 6]
8 96 [5 8 3 9 2 1 0 7]
8 96 [0 6 9 3 2 4 5 1]
8 96 [0 6 1 3 2 7 8 9]
8 96 [3 5 6 7 0 2 1 9]
8 97 [8 0 4 3 9 1 2 6]
8 97 [5 8 3 9 2 1 0 7]
8 97 [0 6 9 3 2 4 5 1]
8 97 [0 6 1 3 2 7 8 9]
8 97 [3 5 6 7 0 2 1 9]
8 96 [8 0 4 3 9 1 2 6]
8 96 [5 8 3 9 2 1 0 7]
8 96 [0 6 9 3 2 4 5 1]
8 96 [0 6 1 3 2 7 8 9]
8 96 [3 5 6 7 0 2 1 9]
8 97 [8 0 4 3 9 1 2 6]
8 97 [5 8 3 9 2 1 0 7]
8 97 [0 6 9 3 2 4 5 1]
8 97 [0 6 1 3 2 7 8 9]
8 97 [3 5 6 7 0 2 1 9]
8 96 [8 0 4 3 9 1 2 6]
8 96 [5 8 3 9 2 1 0 7]
8 96 [0 6 9 3 2 4 5 1]
8 96 [0 6 1 3 2 7 8 9]
8 96 [3 5 6 7 0 2 1 9]
8 97 [8 0 4 3 9 1 2 6]
8 97 [5 8 3 9 2 1 0 7]
8 97 [0 6 9 3 2 4 5 1]
8 97 [0 6 1 3 2 7 8 9]
8 97 [3 5 6 7 0 2 1 9]
8 96 [8 0 4 3 9 1 2 6]
8 96 [5 8 3 9 2 1 0 7]
8 96 [0 6 9 3 2 4 5 1]
8 96 [0 6 1 3 2 7 8 9]
8 96 [3 5 6 7 0 2 1 9]
8 97 [8 0 4 3 9 1 2 6]
8 97 [5 8 3 9 2 1 0 7]
8 97 [0 6 9 3 2 4 5 1]
8 97 [0 6 1 3 2 7 8 9]
8 97 [3 5 6 7 0 2 1 9]
8 96 [8 0 4 3 9 1 2 6]
8 96 [5 8 3 9 2 1 0 7]
8 96 [0 6 9 3 2 4 5 1]
8 96 [0 6 1 3 2 7 8 9]
8 96 [3 5 6 7 0 2 1 9]
8 97 [8 0 4 3 9 1 2 6]
8 97 [5 8 3 9 2 1 0 7]
8 97 [0 6 9 3 2 4 5 1]
8 97 [0 6 1 3 2 7 8 9]
8 97 [3 5 6 7 0 2 1 9]
8 96 [8 0 4 3 9 1 2 6]
8 96 [5 8 3 9 2 1 0 7]
8 96 [0 6 9 3 2 4 5 1]
8 96 [0 6 1 3 2 7 8 9]
8 96 [3 5 6 7 0 2 1 9]
8 97 [8 0 4 3 9 1 2 6]
8 97 [5 8 3 9 2 1 0 7]
8 97 [0 6 9 3 2 4 5 1]
8 97 [0 6 1 3 2 7 8 9]
8 97 [3 5 6 7 0 2 1 9]
8 96 [8 0 4 3 9 1 2 6]
8 96 [5 8 3 9 2 1 0 7]
8 96 [0 6 9 3 2 4 5 1]
8 96 [0 6 1 3 2 7 8 9]
8 96 [3 5 6 7 0 2 1 9]
8 97 [8 0 4 3 9 1 2 6]
8 97 [5 8 3 9 2 1 0 7]
8 97 [0 6 9 3 2 4 5 1]
8 97 [0 6 1 3 2 7 8 9]
8 97 [3 5 6 7 0 2 1 9]
8 96 [8 0 4 3 9 1 2 6]
8 96 [5 8 3 9 2 1 0 7]
8 96 [0 6 9 3 2 4 5 1]
8 96 [0 6 1 3 2 7 8 9]
8 96 [3 5 6 7 0 2 1 9]
8 97 [8 0 4 3 9 1 2 6]
8 97 [5 8 3 9 2 1 0 7]
8 97 [0 6 9 3 2 4 5 1]
8 97 [0 6 1 3 2 7 8 9]
8 97 [3 5 6 7 0 2 1 9]
8 96 [8 0 4 3 9 1 2 6]
8 96 [5 8 3 9 2 1 0 7]
8 96 [0 6 9 3 2 4 5 1]
8 96 [0 6 1 3 2 7 8 9]
8 96 [3 5 6 7 0 2 1 9]
8 97 [8 0 4 3 9 1 2 6]
8 97 [5 8 3 9 2 1 0 7]
8 97 [0 6 9 3 2 4 5 1]
8 97 [0 6 1 3 2 7 8 9]
8 97 [3 5 6 7 0 2 1 9]
8 96 [8 0 4 3 9 1 2 6]
8 96 [5 8 3 9 2 1 0 7]
8 96 [0 6 9 3 2 4 5 1]
8 96 [0 6 1 3 2 7 8 9]
8 96 [3 5 6 7 0 2 1 9]
8 97 [8 0 4 3 9 1 2 6]
8 97 [5 8 3 9 2 1 0 7]
8 97 [0 6 9 3 2 4 5 1]
8 97 [0 6 1 3 2 7 8 9]
8 97 [3 5 6 7 0 2 1 9]
8 96 [8 0 4 3 9 1 2 6]
8 96 [5 8 3 9 2 1 0 7]
8 96 [0 6 9 3 2 4 5 1]
8 96 [0 6 1 3 2 7 8 9]
8 96 [3 5 6 7 0 2 1 9]
8 97 [8 0 4 3 9 1 2 6]
8 97 [5 8 3 9 2 1 0 7]
8 97 [0 6 9 3 2 4 5 1]
8 97 [0 6 1 3 2 7 8 9]
8 97 [3 5 6 7 0 2 1 9]
8 96 [8 0 4 3 9 1 2 6]
8 96 [5 8 3 9 2 1 0 7]
8 96 [0 6 9 3 2 4 5 1]
8 96 [0 6 1 3 2 7 8 9]
8 96 [3 5 6 7 0 2 1 9]
8 97 [8 0 4 3 9 1 2 6]
8 97 [5 8 3 9 2 1 0 7]
8 97 [0 6 9 3 2 4 5 1]
8 97 [0 6 1 3 2 7 8 9]
8 97 [3 5 6 7 0 2 1 9]
8 96 [8 0 4 3 9 1 2 6]
8 96 [5 8 3 9 2 1 0 7]
8 96 [0 6 9 3 2 4 5 1]
8 96 [0 6 1 3 2 7 8 9]
8 96 [3 5 6 7 0 2 1 9]
8 97 [8 0 4 3 9 1 2 6]
8 97 [5 8 3 9 2 1 0 7]
8 97 [0 6 9 3 2 4 5 1]
8 97 [0 6 1 3 2 7 8 9]
8 97 [3 5 6 7 0 2 1 9]
8 96 [8 0 4 3 9 1 2 6]
8 96 [5 8 3 9 2 1 0 7]
8 96 [0 6 9 3 2 4 5 1]
8 96 [0 6 1 3 2 7 8 9]
8 96 [3 5 6 7 0 2 1 9]
Traceback (most recent call last):
  File "/home/kemove/lt/FedAlgorithm/alg/FedStream.py", line 770, in <module>
    alg.online_train()
  File "/home/kemove/lt/FedAlgorithm/alg/FedStream.py", line 733, in online_train
    global_loss_list, accuracy_list = self.alg.run(
                                      ^^^^^^^^^^^^^
  File "/home/kemove/lt/FedAlgorithm/alg/FedProx.py", line 113, in run
    result = self.client_group.clients[k].local_update_prox(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kemove/lt/FedAlgorithm/alg/Clients.py", line 235, in local_update_prox
    for batch in dataloader:
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 675, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torch/utils/data/dataset.py", line 348, in __getitem__
    return self.datasets[dataset_idx][sample_idx]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torch/utils/data/dataset.py", line 348, in __getitem__
    return self.datasets[dataset_idx][sample_idx]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torch/utils/data/dataset.py", line 348, in __getitem__
    return self.datasets[dataset_idx][sample_idx]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  [Previous line repeated 3 more times]
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torch/utils/data/dataset.py", line 411, in __getitem__
    return self.dataset[self.indices[idx]]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torch/utils/data/dataset.py", line 411, in __getitem__
    return self.dataset[self.indices[idx]]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torch/utils/data/dataset.py", line 411, in __getitem__
    return self.dataset[self.indices[idx]]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  [Previous line repeated 39 more times]
  File "/home/kemove/lt/FedAlgorithm/alg/Clients.py", line 37, in __getitem__
    data = self.trans(self.local_data[index])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torchvision/transforms/transforms.py", line 95, in __call__
    img = t(img)
          ^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torchvision/transforms/transforms.py", line 137, in __call__
    return F.to_tensor(pic)
           ^^^^^^^^^^^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torchvision/transforms/functional.py", line 168, in to_tensor
    img = torch.from_numpy(np.array(pic, mode_to_nptype.get(pic.mode, np.uint8), copy=True))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
