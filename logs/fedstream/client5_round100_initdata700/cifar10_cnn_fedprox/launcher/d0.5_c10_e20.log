Running FedStream with: Dir=0.5, Init_Class=10, Epoch=20
Files already downloaded and verified
Files already downloaded and verified
has read
Files already downloaded and verified
Files already downloaded and verified
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:53<1:28:01, 53.34s/it]  2%|▏         | 2/100 [01:53<1:34:07, 57.63s/it]  3%|▎         | 3/100 [03:07<1:44:59, 64.94s/it]  4%|▍         | 4/100 [04:32<1:56:41, 72.93s/it]  5%|▌         | 5/100 [06:03<2:05:37, 79.34s/it]  6%|▌         | 6/100 [07:38<2:12:24, 84.51s/it]  7%|▋         | 7/100 [09:04<2:12:08, 85.25s/it]  8%|▊         | 8/100 [10:37<2:14:13, 87.54s/it]  9%|▉         | 9/100 [12:12<2:16:28, 89.99s/it] 10%|█         | 10/100 [13:51<2:19:02, 92.70s/it] 11%|█         | 11/100 [15:33<2:21:58, 95.72s/it] 12%|█▏        | 12/100 [17:20<2:25:11, 98.99s/it] 13%|█▎        | 13/100 [19:00<2:24:12, 99.46s/it] 14%|█▍        | 14/100 [20:42<2:23:21, 100.01s/it] 15%|█▌        | 15/100 [22:23<2:22:14, 100.41s/it] 16%|█▌        | 16/100 [24:08<2:22:25, 101.73s/it] 17%|█▋        | 17/100 [25:50<2:20:49, 101.80s/it] 18%|█▊        | 18/100 [27:32<2:19:24, 102.01s/it] 19%|█▉        | 19/100 [29:15<2:18:09, 102.34s/it] 20%|██        | 20/100 [30:58<2:16:24, 102.30s/it] 21%|██        | 21/100 [32:48<2:17:51, 104.70s/it] 22%|██▏       | 22/100 [34:28<2:14:20, 103.34s/it] 23%|██▎       | 23/100 [36:13<2:13:10, 103.78s/it] 24%|██▍       | 24/100 [37:58<2:12:05, 104.29s/it] 25%|██▌       | 25/100 [39:43<2:10:30, 104.41s/it] 26%|██▌       | 26/100 [41:31<2:10:07, 105.51s/it] 27%|██▋       | 27/100 [43:17<2:08:22, 105.51s/it] 28%|██▊       | 28/100 [45:02<2:06:29, 105.41s/it] 29%|██▉       | 29/100 [46:46<2:04:27, 105.17s/it] 30%|███       | 30/100 [48:32<2:02:44, 105.21s/it] 31%|███       | 31/100 [50:21<2:02:17, 106.34s/it] 32%|███▏      | 32/100 [52:07<2:00:36, 106.41s/it] 33%|███▎      | 33/100 [53:59<2:00:40, 108.07s/it] 34%|███▍      | 34/100 [56:03<2:03:56, 112.67s/it] 35%|███▌      | 35/100 [58:06<2:05:23, 115.75s/it] 36%|███▌      | 36/100 [59:54<2:01:13, 113.65s/it] 37%|███▋      | 37/100 [1:01:41<1:56:58, 111.41s/it] 38%|███▊      | 38/100 [1:03:27<1:53:34, 109.91s/it] 39%|███▉      | 39/100 [1:05:13<1:50:40, 108.86s/it] 40%|████      | 40/100 [1:07:01<1:48:31, 108.52s/it] 41%|████      | 41/100 [1:08:51<1:47:00, 108.83s/it] 41%|████      | 41/100 [1:09:51<1:40:32, 102.24s/it]
5 154 [8 0 4 3 9]
5 140 [5 8 3 9 2]
5 150 [0 6 9 3 2]
5 152 [0 6 1 3 2]
5 154 [3 5 6 7 0]
5 111 [8 0 4 3 9]
5 112 [5 8 3 9 2]
5 112 [0 6 9 3 2]
5 111 [0 6 1 3 2]
5 111 [3 5 6 7 0]
5 133 [8 0 4 3 9]
5 132 [5 8 3 9 2]
5 132 [0 6 9 3 2]
5 133 [0 6 1 3 2]
5 133 [3 5 6 7 0]
5 145 [8 0 4 3 9]
5 145 [5 8 3 9 2]
5 145 [0 6 9 3 2]
5 145 [0 6 1 3 2]
5 145 [3 5 6 7 0]
5 150 [8 0 4 3 9]
5 151 [5 8 3 9 2]
5 151 [0 6 9 3 2]
5 151 [0 6 1 3 2]
5 150 [3 5 6 7 0]
5 153 [8 0 4 3 9]
5 153 [5 8 3 9 2]
5 153 [0 6 9 3 2]
5 153 [0 6 1 3 2]
5 153 [3 5 6 7 0]
5 154 [8 0 4 3 9]
5 154 [5 8 3 9 2]
5 154 [0 6 9 3 2]
5 154 [0 6 1 3 2]
5 154 [3 5 6 7 0]
5 155 [8 0 4 3 9]
5 154 [5 8 3 9 2]
5 154 [0 6 9 3 2]
5 154 [0 6 1 3 2]
5 155 [3 5 6 7 0]
5 154 [8 0 4 3 9]
5 155 [5 8 3 9 2]
5 155 [0 6 9 3 2]
5 155 [0 6 1 3 2]
5 154 [3 5 6 7 0]
5 155 [8 0 4 3 9]
5 154 [5 8 3 9 2]
5 154 [0 6 9 3 2]
5 154 [0 6 1 3 2]
5 155 [3 5 6 7 0]
5 154 [8 0 4 3 9]
5 155 [5 8 3 9 2]
5 155 [0 6 9 3 2]
5 155 [0 6 1 3 2]
5 154 [3 5 6 7 0]
5 155 [8 0 4 3 9]
5 155 [5 8 3 9 2]
5 155 [0 6 9 3 2]
5 155 [0 6 1 3 2]
5 155 [3 5 6 7 0]
5 155 [8 0 4 3 9]
5 154 [5 8 3 9 2]
5 154 [0 6 9 3 2]
5 154 [0 6 1 3 2]
5 155 [3 5 6 7 0]
5 154 [8 0 4 3 9]
5 155 [5 8 3 9 2]
5 155 [0 6 9 3 2]
5 155 [0 6 1 3 2]
5 154 [3 5 6 7 0]
5 155 [8 0 4 3 9]
5 154 [5 8 3 9 2]
5 154 [0 6 9 3 2]
5 154 [0 6 1 3 2]
5 155 [3 5 6 7 0]
5 154 [8 0 4 3 9]
5 155 [5 8 3 9 2]
5 155 [0 6 9 3 2]
5 155 [0 6 1 3 2]
5 154 [3 5 6 7 0]
5 155 [8 0 4 3 9]
5 154 [5 8 3 9 2]
5 154 [0 6 9 3 2]
5 154 [0 6 1 3 2]
5 155 [3 5 6 7 0]
5 154 [8 0 4 3 9]
5 155 [5 8 3 9 2]
5 155 [0 6 9 3 2]
5 155 [0 6 1 3 2]
5 154 [3 5 6 7 0]
5 155 [8 0 4 3 9]
5 154 [5 8 3 9 2]
5 154 [0 6 9 3 2]
5 154 [0 6 1 3 2]
5 155 [3 5 6 7 0]
5 154 [8 0 4 3 9]
5 155 [5 8 3 9 2]
5 155 [0 6 9 3 2]
5 155 [0 6 1 3 2]
5 154 [3 5 6 7 0]
5 155 [8 0 4 3 9]
5 154 [5 8 3 9 2]
5 154 [0 6 9 3 2]
5 154 [0 6 1 3 2]
5 155 [3 5 6 7 0]
5 154 [8 0 4 3 9]
5 155 [5 8 3 9 2]
5 155 [0 6 9 3 2]
5 155 [0 6 1 3 2]
5 154 [3 5 6 7 0]
5 155 [8 0 4 3 9]
5 154 [5 8 3 9 2]
5 154 [0 6 9 3 2]
5 154 [0 6 1 3 2]
5 155 [3 5 6 7 0]
5 154 [8 0 4 3 9]
5 155 [5 8 3 9 2]
5 155 [0 6 9 3 2]
5 155 [0 6 1 3 2]
5 154 [3 5 6 7 0]
5 155 [8 0 4 3 9]
5 154 [5 8 3 9 2]
5 154 [0 6 9 3 2]
5 154 [0 6 1 3 2]
5 155 [3 5 6 7 0]
5 154 [8 0 4 3 9]
5 155 [5 8 3 9 2]
5 155 [0 6 9 3 2]
5 155 [0 6 1 3 2]
5 154 [3 5 6 7 0]
5 155 [8 0 4 3 9]
5 154 [5 8 3 9 2]
5 154 [0 6 9 3 2]
5 154 [0 6 1 3 2]
5 155 [3 5 6 7 0]
5 154 [8 0 4 3 9]
5 155 [5 8 3 9 2]
5 155 [0 6 9 3 2]
5 155 [0 6 1 3 2]
5 154 [3 5 6 7 0]
5 155 [8 0 4 3 9]
5 154 [5 8 3 9 2]
5 154 [0 6 9 3 2]
5 154 [0 6 1 3 2]
5 155 [3 5 6 7 0]
5 154 [8 0 4 3 9]
5 155 [5 8 3 9 2]
5 155 [0 6 9 3 2]
5 155 [0 6 1 3 2]
5 154 [3 5 6 7 0]
5 155 [8 0 4 3 9]
5 154 [5 8 3 9 2]
5 154 [0 6 9 3 2]
5 154 [0 6 1 3 2]
5 155 [3 5 6 7 0]
5 154 [8 0 4 3 9]
5 155 [5 8 3 9 2]
5 155 [0 6 9 3 2]
5 155 [0 6 1 3 2]
5 154 [3 5 6 7 0]
5 155 [8 0 4 3 9]
5 154 [5 8 3 9 2]
5 154 [0 6 9 3 2]
5 154 [0 6 1 3 2]
5 155 [3 5 6 7 0]
5 154 [8 0 4 3 9]
5 155 [5 8 3 9 2]
5 155 [0 6 9 3 2]
5 155 [0 6 1 3 2]
5 154 [3 5 6 7 0]
5 155 [8 0 4 3 9]
5 154 [5 8 3 9 2]
5 154 [0 6 9 3 2]
5 154 [0 6 1 3 2]
5 155 [3 5 6 7 0]
5 154 [8 0 4 3 9]
5 155 [5 8 3 9 2]
5 155 [0 6 9 3 2]
5 155 [0 6 1 3 2]
5 154 [3 5 6 7 0]
5 155 [8 0 4 3 9]
5 154 [5 8 3 9 2]
5 154 [0 6 9 3 2]
5 154 [0 6 1 3 2]
5 155 [3 5 6 7 0]
5 154 [8 0 4 3 9]
5 155 [5 8 3 9 2]
5 155 [0 6 9 3 2]
5 155 [0 6 1 3 2]
5 154 [3 5 6 7 0]
5 155 [8 0 4 3 9]
5 154 [5 8 3 9 2]
5 154 [0 6 9 3 2]
5 154 [0 6 1 3 2]
5 155 [3 5 6 7 0]
5 154 [8 0 4 3 9]
5 155 [5 8 3 9 2]
5 155 [0 6 9 3 2]
5 155 [0 6 1 3 2]
5 154 [3 5 6 7 0]
5 155 [8 0 4 3 9]
5 154 [5 8 3 9 2]
5 154 [0 6 9 3 2]
5 154 [0 6 1 3 2]
5 155 [3 5 6 7 0]
5 154 [8 0 4 3 9]
5 155 [5 8 3 9 2]
5 155 [0 6 9 3 2]
Traceback (most recent call last):
  File "/home/kemove/lt/FedAlgorithm/alg/FedStream.py", line 770, in <module>
    alg.online_train()
  File "/home/kemove/lt/FedAlgorithm/alg/FedStream.py", line 733, in online_train
    global_loss_list, accuracy_list = self.alg.run(
                                      ^^^^^^^^^^^^^
  File "/home/kemove/lt/FedAlgorithm/alg/FedProx.py", line 113, in run
    result = self.client_group.clients[k].local_update_prox(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kemove/lt/FedAlgorithm/alg/Clients.py", line 235, in local_update_prox
    for batch in dataloader:
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 675, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torch/utils/data/dataset.py", line 348, in __getitem__
    return self.datasets[dataset_idx][sample_idx]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torch/utils/data/dataset.py", line 348, in __getitem__
    return self.datasets[dataset_idx][sample_idx]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torch/utils/data/dataset.py", line 348, in __getitem__
    return self.datasets[dataset_idx][sample_idx]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  [Previous line repeated 1 more time]
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torch/utils/data/dataset.py", line 411, in __getitem__
    return self.dataset[self.indices[idx]]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torch/utils/data/dataset.py", line 411, in __getitem__
    return self.dataset[self.indices[idx]]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torch/utils/data/dataset.py", line 411, in __getitem__
    return self.dataset[self.indices[idx]]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  [Previous line repeated 39 more times]
  File "/home/kemove/lt/FedAlgorithm/alg/Clients.py", line 37, in __getitem__
    data = self.trans(self.local_data[index])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torchvision/transforms/transforms.py", line 95, in __call__
    img = t(img)
          ^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torchvision/transforms/transforms.py", line 277, in forward
    return F.normalize(tensor, self.mean, self.std, self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torchvision/transforms/functional.py", line 350, in normalize
    return F_t.normalize(tensor, mean=mean, std=std, inplace=inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kemove/anaconda3/envs/test/lib/python3.11/site-packages/torchvision/transforms/_functional_tensor.py", line 919, in normalize
    std = torch.as_tensor(std, dtype=dtype, device=tensor.device)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
